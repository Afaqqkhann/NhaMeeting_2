@extends("base")

@section('sidebar')
@parent
    <h1>Community Message</h1>
@endsection

@section('content')


<div class="box  box-primary">
    <div class="box-body">
      <table class="table table-bordered table-stripped table-responsive">
          <tr>
              <th>Message Type</th><td>{{ $data->title }}</td>
          </tr>
          <tr>
              <th>Relation</th><td>{{ $data->r_title }}</td>
          </tr>
          <tr>
              <th>Message</th><td>{{ $data->message }}</td>
          </tr>
          <tr>
              <th>Coordinates</th><td>{{$data->coordinates}}<?php $coordinates = explode(',', $data->coordinates) ?></td>
          </tr>

          <tr>
              <th>Location:</th>
              <td>
                  <div id="map-canvas" style="height:300px !important;"></div>
              </td>
          </tr>

          <tr>
              <th>Image Gallery</th>
              <td>
                  <?php $pictures = DB::table('TBL_COMMUNITY_PICTURE')->where('COMMUNITY_ID', '=', $data->community_id)->get();?>
                  @foreach($pictures as $picture)
                      <a class="fancybox" rel="gallery1" href="{{url($picture->community_edoc)}}">
                          <img src="{{url($picture->community_edoc)}}" />
                      </a>
                  @endforeach

              </td>
          </tr>

      </table>
    </div><!-- /.box-body -->
</div><!-- /.box -->
<a href="{{ URL::to('community_msg') }}" class="btn btn-primary" >Back</a>

<style>
    .fancybox > img { width: 200px !important; }
</style>

<link rel="stylesheet" href="{{url('public/plugins/fancybox/jquery.fancybox.css')}}">
<script src="{{url('public/plugins/fancybox/jquery.fancybox.js')}}" type="text/javascript"></script>

<script>
    $(document).ready(function() {
        $(".fancybox").fancybox({
            openEffect	: 'none',
            closeEffect	: 'none'
        });
    });

</script>

<script>

    function initMain() {
        var map = new google.maps.Map(document.getElementById('map-canvas'), {
            center: {
                lat: @if($coordinates[0] != '' || $coordinates[0] != null) {{$coordinates[0]}} @else 33.71333479999999 @endif,
                lng: @if($coordinates[1] != '' || $coordinates[1] != null) {{$coordinates[1]}} @else 73.06192609999994 @endif
            },
            zoom: 15,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        });
        var marker = new google.maps.Marker({
            position: {
                lat: @if($coordinates[0] != '' || $coordinates[0] != null) {{$coordinates[0]}} @else 33.71333479999999 @endif,
                lng: @if($coordinates[1] != '' || $coordinates[1] != null) {{$coordinates[1]}} @else 73.06192609999994 @endif
            },
            draggable: false,
            map: map
        });

    }
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAw3lSrcwKAhj3uaJcjES87gG0bv1jtVu8&libraries=places&callback=initMain" async defer></script>

@stop
